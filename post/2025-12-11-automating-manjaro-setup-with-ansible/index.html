<!doctype html>
<head>
  
  
  
  <link rel="stylesheet" href="https://pauloportugal.github.io/css/main.min.c55e8a3d90783e730dc058804a2726f26d7488162dd2f074752301ca9c1b8657.css">
</head>
<html lang="en">
  
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no, initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  <meta property="og:url" content="https://pauloportugal.github.io/post/2025-12-11-automating-manjaro-setup-with-ansible/">
  <meta property="og:site_name" content="Paulo Monteiro">
  <meta property="og:title" content="Automating Manjaro Setup with Ansible">
  <meta property="og:description" content="An Ansible-based automation framework that streamlines post-installation configuration of Manjaro Linux.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2025-12-11T22:44:55+00:00">
    <meta property="article:modified_time" content="2025-12-11T22:44:55+00:00">
    <meta property="article:tag" content="Ansible">
    <meta property="article:tag" content="Manjaro">
    <meta property="article:tag" content="Automation">
    <meta property="article:tag" content="Infrastructure-as-Code">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="Devops">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Automating Manjaro Setup with Ansible">
  <meta name="twitter:description" content="An Ansible-based automation framework that streamlines post-installation configuration of Manjaro Linux.">

  
  <meta itemprop="name" content="Automating Manjaro Setup with Ansible">
  <meta itemprop="description" content="An Ansible-based automation framework that streamlines post-installation configuration of Manjaro Linux.">
  <meta itemprop="datePublished" content="2025-12-11T22:44:55+00:00">
  <meta itemprop="dateModified" content="2025-12-11T22:44:55+00:00">
  <meta itemprop="wordCount" content="1353">
  <meta itemprop="keywords" content="Ansible,Manjaro,Automation,Infrastructure-as-Code,Linux,Devops">

  <title>
    
      Automating Manjaro Setup with Ansible | 
    
    Paulo Monteiro
  </title>

  <link rel="apple-touch-icon" sizes="180x180" href="/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicons/favicon-16x16.png">

<link rel="shortcut icon" href="/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Paulo Monteiro">
<meta name="application-name" content="Paulo Monteiro">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

  
  
    
      
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  
  

  
  
  
  
  <link rel="stylesheet" href="https://pauloportugal.github.io/css/main.min.c55e8a3d90783e730dc058804a2726f26d7488162dd2f074752301ca9c1b8657.css">

  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&amp;family=Source&#43;Sans&#43;Pro:wght@400;600;700;900&amp;display=swap">

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="/">
  

  
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  
  <script src="/js/modules/theme.js"></script>

  













  

  
    
    
      
    
    
      
    
  



  
  
  
    
  
  
    
  
  
    
  
  
    
  



  
    
      
    
  





  <script src="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/js/glightbox.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.13/dayjs.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.13/locale/en.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.13/plugin/relativeTime.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.13/plugin/localizedFormat.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.js"></script>




  
<script defer src="/js/post.js"></script>





  
  


  
    
    

    
    
  

  


<link rel="stylesheet" href="https://pauloportugal.github.io/css/custom.css">


</head>
  <body>
    
<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/img/commons/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Paulo Monteiro</a>
    
      <p class="site-subtitle fst-italic mb-0">A Web corner for thoughts and projects</p>
    
  </header>
  

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      
        
        
        <li class="nav-item">
          <a href="/" class="nav-link">
            <i class="fa-fw fas fa-house"></i>
            <span>HOME</span>
          </a>
        </li>
        
      
        
        
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            <span>CATEGORIES</span>
          </a>
        </li>
        
      
        
        
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            <span>TAGS</span>
          </a>
        </li>
        
      
        
        
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            <span>ARCHIVES</span>
          </a>
        </li>
        
      
        
        
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            <span>ABOUT</span>
          </a>
        </li>
        
      
      <li class="nav-item mt-4">
        <a class="nav-link no-hover">
          <i class="fa-fw fas fa-language"></i>
          <div class="lang-dropdown">
  <select class="lang-select" onchange="location = this.value;">
    
    
    
    <option value="https://pauloportugal.github.io/pt-pt/" >
      Português
    </option>
    
    <option value="https://pauloportugal.github.io/en/" selected>
      English
    </option>
    
  </select>
</div>
        </a>
      </li>
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      
      
      
      
        
      

      
        <a
          href="https://github.com/pauloportugal"
          aria-label="github"
          target="_blank" rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      
      
      
      
        
      

      
        <a
          href="https://twitter.com/paulomonteiro82"
          aria-label="twitter"
          target="_blank" rel="noopener noreferrer"
          
        >
          <i class="fab fa-twitter"></i>
        </a>
      
    
      
      
      
      
        
      

      
        <a
          href="https://bsky.app/profile/paulo-monteiro.bsky.social"
          aria-label="bluesky"
          target="_blank" rel="noopener noreferrer"
          
        >
          <i class="fab fa-bluesky"></i>
        </a>
      
    
      
      
      
      
        
      

      
        <a
          href="https://pauloportugal.github.io/index.xml"
          aria-label="rss"
          
          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  
</aside>

    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        
<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100">
    <nav id="breadcrumb" aria-label="Breadcrumb">
      
      
      
      

      
        <span>
          <a href="/">Home</a>
        </span>
        
        
          
          
            
          
            
          
            
          
            
          
            
          

          
          
            <span>Automating Manjaro Setup with Ansible</span>  
          


        
      
    </nav>
    

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Automating Manjaro Setup with Ansible
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>
        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
  
  
  

  <article class="px-1" data-toc="true">
    <header>
      <h1 data-toc-skip>Automating Manjaro Setup with Ansible</h1>
      
        <p class="post-desc fw-light mb-4">An Ansible-based automation framework that streamlines post-installation configuration of Manjaro Linux.</p>
      

      <div class="post-meta text-muted">
        
        <span>
          Posted
          



<time
  
  data-ts="1765493095"
  data-df="ll"
  data-bs-toggle="tooltip" data-bs-placement="bottom"
>
  %b %e, %Y
</time>
        </span>

        
        
          <span>
            Updated
            



<time
  
  data-ts="1765493095"
  data-df="ll"
  data-bs-toggle="tooltip" data-bs-placement="bottom"
>
  %b %e, %Y
</time>
          </span>
        

        
          
          
          
          
          

          
          

          <div class="mt-3 mb-3">
            <img src="/post/2025-12-11-automating-manjaro-setup-with-ansible/ansible-manjaro.png" class="preview-img" alt="Manjaro Linux and Ansible automation - streamlining system configuration with infrastructure as code" w="1200" h="630" ><figcaption class="text-center pt-2 pb-2">Manjaro Linux and Ansible automation - streamlining system configuration with infrastructure as code</figcaption></div>
        

        <div class="d-flex justify-content-between">
          
          <span>
            
            
              
            
            


            By

            <em>
              
                
                  
                    Paulo Monteiro
                  
                  
                
              
            </em>
          </span>

          <div>
            
            

            
            















<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2223 words"
>
  <em>12 min</em> read</span>

          </div>
        </div>
      </div>
    </header>

    
      <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
        <span class="label text-truncate">Automating Manjaro Setup with Ansible</span>
        <button type="button" class="toc-trigger btn me-1">
          <i class="fa-solid fa-list-ul fa-fw"></i>
        </button>
      </div>

      <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
        <span class="label ps-2 pe-1">Contents</span>
        <i class="fa-solid fa-angle-right fa-fw"></i>
      </button>

      <dialog id="toc-popup" class="p-0">
        <div class="header d-flex flex-row align-items-center justify-content-between">
          <div class="label text-truncate py-2 ms-4">Automating Manjaro Setup with Ansible</div>
          <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
            <i class="fas fa-close"></i>
          </button>
        </div>
        <div id="toc-popup-content" class="px-4 py-3 pb-4"><nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#the-problem-it-solves">The Problem It Solves</a></li>
    <li><a href="#architecture--design">Architecture &amp; Design</a>
      <ul>
        <li><a href="#modular-role-based-structure">Modular Role-Based Structure</a></li>
        <li><a href="#package-management-strategy">Package Management Strategy</a></li>
      </ul>
    </li>
    <li><a href="#key-features">Key Features</a>
      <ul>
        <li><a href="#development-environment-stack">Development Environment Stack</a></li>
        <li><a href="#testing-infrastructure">Testing Infrastructure</a></li>
        <li><a href="#code-quality-automation">Code Quality Automation</a></li>
      </ul>
    </li>
    <li><a href="#getting-started">Getting Started</a>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#installation">Installation</a></li>
        <li><a href="#running-the-playbook">Running the Playbook</a></li>
        <li><a href="#selective-installation">Selective Installation</a></li>
      </ul>
    </li>
    <li><a href="#real-world-use-cases">Real-World Use Cases</a>
      <ul>
        <li><a href="#fresh-installation-recovery">Fresh Installation Recovery</a></li>
        <li><a href="#multi-machine-consistency">Multi-Machine Consistency</a></li>
        <li><a href="#onboarding-new-team-members">Onboarding New Team Members</a></li>
        <li><a href="#configuration-experimentation">Configuration Experimentation</a></li>
      </ul>
    </li>
    <li><a href="#technical-highlights">Technical Highlights</a>
      <ul>
        <li><a href="#idempotency">Idempotency</a></li>
        <li><a href="#error-handling--debug-modes">Error Handling &amp; Debug Modes</a></li>
        <li><a href="#version-control--release-management">Version Control &amp; Release Management</a></li>
      </ul>
    </li>
    <li><a href="#lessons-learned--best-practices">Lessons Learned &amp; Best Practices</a></li>
    <li><a href="#future-enhancements">Future Enhancements</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#resources">Resources</a></li>
  </ul>
</nav></div>
      </dialog>
    

    <div class="content">
      




<h2 id="overview" id=overview>
  
    <span class="me-2">Overview</span>
    <a href="#overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h2><p>Setting up a fresh Linux installation can be a time-consuming and repetitive process. Every time you install Manjaro (or any Linux distribution), you face the same tedious tasks: installing your favorite applications, configuring your development environment, setting up tools, and tweaking system settings to match your preferences.</p>
<p>Enter <a href="https://github.com/PauloPortugal/manjaro-playbook">Manjaro Playbook</a> - an Ansible-based automation framework that transforms this multi-hour ordeal into a single command execution. This project represents the &ldquo;infrastructure as code&rdquo; philosophy applied to personal workstation configuration.</p>
<h2 id="the-problem-it-solves" id=the-problem-it-solves>
  
    <span class="me-2">The Problem It Solves</span>
    <a href="#the-problem-it-solves" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h2><p>After installing a fresh copy of Manjaro Linux with GNOME 3, you typically need to:</p>
<ul>
<li>Install dozens of packages from official repositories</li>
<li>Configure AUR (Arch User Repository) packages</li>
<li>Set up development environments (Docker, Kubernetes, multiple language runtimes)</li>
<li>Install and configure productivity tools</li>
<li>Configure system services like firewalls and printers</li>
<li>Customize GNOME settings</li>
<li>Set up communication tools</li>
</ul>
<p>Doing this manually is error-prone, inconsistent, and wastes valuable time. Even worse, you can&rsquo;t easily replicate your setup across multiple machines or recover quickly from system failures.</p>
<h2 id="architecture--design" id=architecture--design>
  
    <span class="me-2">Architecture &amp; Design</span>
    <a href="#architecture--design" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h2><h3 id="modular-role-based-structure" id=modular-role-based-structure>
  
    <span class="me-2">Modular Role-Based Structure</span>
    <a href="#modular-role-based-structure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p>The playbook follows Ansible best practices with a modular, role-based architecture. Each role represents a logical component of your system configuration:</p>
<div class="code-block">
  <div class="code-header"> <span data-label-text="Text"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div>
  
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">manjaro-playbook/
</span></span><span class="line"><span class="cl">├── roles/
</span></span><span class="line"><span class="cl">│   ├── base/              # System foundation packages
</span></span><span class="line"><span class="cl">│   ├── users/             # User account configuration
</span></span><span class="line"><span class="cl">│   ├── browsers/          # Web browsers
</span></span><span class="line"><span class="cl">│   ├── dev-tools/         # Development stack
</span></span><span class="line"><span class="cl">│   ├── editors/           # Code editors &amp; IDEs
</span></span><span class="line"><span class="cl">│   ├── virtualization/    # Vagrant, VirtualBox
</span></span><span class="line"><span class="cl">│   ├── comms/             # Communication tools
</span></span><span class="line"><span class="cl">│   ├── cloud-tools/       # Cloud platform CLIs
</span></span><span class="line"><span class="cl">│   ├── multimedia/        # Media applications
</span></span><span class="line"><span class="cl">│   ├── audio-tools/       # Audio production
</span></span><span class="line"><span class="cl">│   ├── printers/          # Printing services
</span></span><span class="line"><span class="cl">│   ├── clamav/            # Antivirus
</span></span><span class="line"><span class="cl">│   └── ...</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>This modular design provides several benefits:</p>
<ul>
<li><strong>Selective Installation</strong>: Install only what you need using tags</li>
<li><strong>Maintainability</strong>: Each role is self-contained and easy to update</li>
<li><strong>Reusability</strong>: Roles can be shared across different playbooks</li>
<li><strong>Clarity</strong>: Clear separation of concerns makes the codebase understandable</li>
</ul>
<h3 id="package-management-strategy" id=package-management-strategy>
  
    <span class="me-2">Package Management Strategy</span>
    <a href="#package-management-strategy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p>One of Manjaro Playbook&rsquo;s strengths is how it handles multiple package sources:</p>
<p><strong>Official Repositories (Pacman)</strong>: Core system packages and widely-used applications are installed via Manjaro&rsquo;s official repositories using the <code>pacman</code> module.</p>
<p><strong>AUR Packages</strong>: The Arch User Repository provides access to thousands of community-maintained packages. The playbook uses <code>pamac</code> (Manjaro&rsquo;s package manager) to automate AUR package installation, which is typically a manual process.</p>
<p><strong>Custom Scripts</strong>: For packages requiring special handling or those not available through standard channels, the playbook includes custom shell scripts.</p>
<h2 id="key-features" id=key-features>
  
    <span class="me-2">Key Features</span>
    <a href="#key-features" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h2><h3 id="development-environment-stack" id=development-environment-stack>
  
    <span class="me-2">Development Environment Stack</span>
    <a href="#development-environment-stack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p>The <code>dev-tools</code> role is particularly comprehensive, installing a complete modern development stack:</p>
<ul>
<li><strong>Containerization</strong>: Docker and Kubernetes (kubectl, minikube)</li>
<li><strong>Languages &amp; Runtimes</strong>: Java (OpenJDK), Node.js, Go, Scala</li>
<li><strong>Build Tools</strong>: Maven, Gradle, npm</li>
<li><strong>Version Control</strong>: Git with configuration</li>
<li><strong>Cloud Tools</strong>: AWS CLI, Azure CLI, Google Cloud SDK</li>
</ul>
<p>All configured and ready to use after a single playbook run.</p>
<h3 id="testing-infrastructure" id=testing-infrastructure>
  
    <span class="me-2">Testing Infrastructure</span>
    <a href="#testing-infrastructure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p>One of the most impressive aspects of this project is its testing infrastructure. Before deploying changes to your production system, you can:</p>
<p><strong>Vagrant Testing</strong>: The playbook includes a complete Vagrant configuration that spins up a VirtualBox VM running Manjaro, applies the playbook, and lets you verify everything works correctly in isolation.</p>
<div class="code-block">
  <div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div>
  
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Test the entire playbook in a VM</span>
</span></span><span class="line"><span class="cl">vagrant up</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>This is a game-changer for safety - you never have to worry about a misconfigured playbook breaking your main system.</p>
<h3 id="code-quality-automation" id=code-quality-automation>
  
    <span class="me-2">Code Quality Automation</span>
    <a href="#code-quality-automation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p>The project implements several quality assurance mechanisms:</p>
<ul>
<li><strong>Pre-commit Hooks</strong>: Automatically validate code before commits</li>
<li><strong>YAML Linting</strong>: Ensures all YAML files follow best practices</li>
<li><strong>Ansible Linting</strong>: Checks playbooks against Ansible best practices</li>
<li><strong>CI/CD Pipeline</strong>: GitHub Actions automatically test changes</li>
</ul>
<p>This level of quality control ensures reliability and maintainability.</p>
<h2 id="getting-started" id=getting-started>
  
    <span class="me-2">Getting Started</span>
    <a href="#getting-started" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h2><h3 id="prerequisites" id=prerequisites>
  
    <span class="me-2">Prerequisites</span>
    <a href="#prerequisites" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p>After a fresh Manjaro installation, you need:</p>
<div class="code-block">
  <div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div>
  
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Update system mirrors and packages</span>
</span></span><span class="line"><span class="cl">sudo pacman-mirrors --fasttrack
</span></span><span class="line"><span class="cl">sudo pacman -Syu
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install Git and Ansible</span>
</span></span><span class="line"><span class="cl">sudo pacman -S git ansible python-pip</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<h3 id="installation" id=installation>
  
    <span class="me-2">Installation</span>
    <a href="#installation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p>Clone the repository and run the setup script:</p>
<div class="code-block">
  <div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div>
  
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Clone via SSH (requires GitHub SSH keys configured)</span>
</span></span><span class="line"><span class="cl">git clone git@github.com:PauloPortugal/manjaro-playbook.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> manjaro-playbook
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install dependencies</span>
</span></span><span class="line"><span class="cl">./setup.sh</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<h3 id="running-the-playbook" id=running-the-playbook>
  
    <span class="me-2">Running the Playbook</span>
    <a href="#running-the-playbook" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p>The playbook requires three variables for execution:</p>
<div class="code-block">
  <div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div>
  
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ansible-playbook main.yml <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --extra-vars <span class="s2">&#34;username=your_username&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --extra-vars <span class="s2">&#34;git_user_name=&#39;Your Name&#39;&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --extra-vars <span class="s2">&#34;git_user_email=your@email.com&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<h3 id="selective-installation" id=selective-installation>
  
    <span class="me-2">Selective Installation</span>
    <a href="#selective-installation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p>You can use Ansible tags to install only specific components:</p>
<div class="code-block">
  <div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div>
  
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Install only browsers</span>
</span></span><span class="line"><span class="cl">ansible-playbook main.yml --tags browsers
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install development tools and editors</span>
</span></span><span class="line"><span class="cl">ansible-playbook main.yml --tags dev-tools,editors
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install everything except virtualization</span>
</span></span><span class="line"><span class="cl">ansible-playbook main.yml --skip-tags virtualization</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<h2 id="real-world-use-cases" id=real-world-use-cases>
  
    <span class="me-2">Real-World Use Cases</span>
    <a href="#real-world-use-cases" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h2><h3 id="fresh-installation-recovery" id=fresh-installation-recovery>
  
    <span class="me-2">Fresh Installation Recovery</span>
    <a href="#fresh-installation-recovery" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p><strong>Scenario</strong>: Your SSD fails, and you need to set up a new system quickly.</p>
<p><strong>Solution</strong>: Install Manjaro, clone the playbook, run it. Within 30-60 minutes (depending on internet speed), you have your complete development environment back, configured exactly as it was.</p>
<h3 id="multi-machine-consistency" id=multi-machine-consistency>
  
    <span class="me-2">Multi-Machine Consistency</span>
    <a href="#multi-machine-consistency" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p><strong>Scenario</strong>: You work on multiple machines (desktop, laptop, work computer) and want identical environments.</p>
<p><strong>Solution</strong>: Run the same playbook on all machines. Every system will have the same tools, configurations, and settings.</p>
<h3 id="onboarding-new-team-members" id=onboarding-new-team-members>
  
    <span class="me-2">Onboarding New Team Members</span>
    <a href="#onboarding-new-team-members" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p><strong>Scenario</strong>: Your team uses Manjaro, and new developers need standardized setups.</p>
<p><strong>Solution</strong>: Fork the playbook, customize it for your team&rsquo;s needs, and provide it as an onboarding tool. New team members can be productive on day one.</p>
<h3 id="configuration-experimentation" id=configuration-experimentation>
  
    <span class="me-2">Configuration Experimentation</span>
    <a href="#configuration-experimentation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p><strong>Scenario</strong>: You want to try new tools or configurations without risking your main system.</p>
<p><strong>Solution</strong>: Use the Vagrant testing infrastructure to experiment in a VM first, then apply successful changes to your production system.</p>
<h2 id="technical-highlights" id=technical-highlights>
  
    <span class="me-2">Technical Highlights</span>
    <a href="#technical-highlights" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h2><h3 id="idempotency" id=idempotency>
  
    <span class="me-2">Idempotency</span>
    <a href="#idempotency" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p>The playbook is designed to be idempotent - you can run it multiple times safely. Ansible&rsquo;s declarative approach ensures that:</p>
<ul>
<li>Packages already installed won&rsquo;t be reinstalled</li>
<li>Existing configurations won&rsquo;t be overwritten unnecessarily</li>
<li>The system converges to the desired state regardless of starting condition</li>
</ul>
<h3 id="error-handling--debug-modes" id=error-handling--debug-modes>
  
    <span class="me-2">Error Handling &amp; Debug Modes</span>
    <a href="#error-handling--debug-modes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p>The playbook includes configurable verbosity levels:</p>
<div class="code-block">
  <div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div>
  
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Standard execution</span>
</span></span><span class="line"><span class="cl">ansible-playbook main.yml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Verbose output for troubleshooting</span>
</span></span><span class="line"><span class="cl">ansible-playbook main.yml -v
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Maximum verbosity for debugging</span>
</span></span><span class="line"><span class="cl">ansible-playbook main.yml -vvv</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<h3 id="version-control--release-management" id=version-control--release-management>
  
    <span class="me-2">Version Control &amp; Release Management</span>
    <a href="#version-control--release-management" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h3><p>The project follows professional software engineering practices:</p>
<ul>
<li><strong>Semantic Versioning</strong>: Clear version numbers indicating compatibility</li>
<li><strong>Change Tracking</strong>: Over 250 commits documenting evolution</li>
<li><strong>Release Notes</strong>: Detailed changelogs for each version</li>
<li><strong>GitHub Actions</strong>: Automated CI/CD pipeline</li>
</ul>
<h2 id="lessons-learned--best-practices" id=lessons-learned--best-practices>
  
    <span class="me-2">Lessons Learned &amp; Best Practices</span>
    <a href="#lessons-learned--best-practices" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h2><p>After maintaining this project across multiple releases, several best practices emerge:</p>
<ol>
<li><strong>Start Small</strong>: Begin with a minimal playbook and gradually add roles as needed</li>
<li><strong>Test First</strong>: Always test in Vagrant before applying to production</li>
<li><strong>Document Everything</strong>: Use clear variable names and include comments explaining non-obvious choices</li>
<li><strong>Version Lock Critical Dependencies</strong>: Pin important package versions to avoid breakage</li>
<li><strong>Separate Secrets</strong>: Never commit sensitive data; use Ansible Vault for credentials</li>
<li><strong>Keep Roles Focused</strong>: Each role should do one thing well</li>
<li><strong>Tag Generously</strong>: Liberal use of tags provides flexibility in execution</li>
</ol>
<h2 id="future-enhancements" id=future-enhancements>
  
    <span class="me-2">Future Enhancements</span>
    <a href="#future-enhancements" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h2><p>While the current playbook is mature and functional, there&rsquo;s always room for improvement:</p>
<ul>
<li><strong>Configuration Management</strong>: Externalize more configurations to variables files</li>
<li><strong>Dotfiles Integration</strong>: Automated management of shell configurations and dotfiles</li>
<li><strong>Backup Integration</strong>: Automated backup configuration and restoration</li>
<li><strong>Profile Variants</strong>: Different profiles for different use cases (development, gaming, content creation)</li>
<li><strong>Distribution Support</strong>: Extend support to other Arch-based distributions</li>
</ul>
<h2 id="conclusion" id=conclusion>
  
    <span class="me-2">Conclusion</span>
    <a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h2><p>The Manjaro Playbook represents automation done right - it solves a real problem, follows best practices, includes comprehensive testing, and maintains high code quality. Whether you&rsquo;re setting up a new system, maintaining multiple machines, or just want to document your perfect development environment, infrastructure-as-code approaches like this playbook are invaluable.</p>
<p>The project demonstrates that personal automation projects can achieve the same professional standards as enterprise infrastructure code. By treating your workstation configuration as code, you gain reproducibility, consistency, and peace of mind knowing you can rebuild your environment at any time.</p>
<p>If you&rsquo;re running Manjaro (or considering it), or if you&rsquo;re interested in infrastructure automation, I highly recommend exploring this approach. The time invested in creating a robust automation playbook pays dividends every time you need to set up or recover a system.</p>
<h2 id="resources" id=resources>
  
    <span class="me-2">Resources</span>
    <a href="#resources" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
  
</h2><ul>
<li><strong>Project Repository</strong>: <a href="https://github.com/PauloPortugal/manjaro-playbook">github.com/PauloPortugal/manjaro-playbook</a></li>
<li><strong>Ansible Documentation</strong>: <a href="https://docs.ansible.com">docs.ansible.com</a></li>
<li><strong>Manjaro Linux</strong>: <a href="https://manjaro.org">manjaro.org</a></li>
<li><strong>Arch User Repository</strong>: <a href="https://aur.archlinux.org">aur.archlinux.org</a></li>
</ul>
<blockquote>
<p>Happy automating! May your systems always converge to their desired state.
{: .prompt-tip }</p>
</blockquote>

    </div>

    <div class="post-tail-wrapper text-muted">
      
      
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw me-1"></i>
          
          
            
              
              <a href="/categories/devops/">DevOps</a>
            
            ,
          
            
              
              
              <a href="/categories/devops/linux/">Linux</a>
            
            
          
        </div>
      

      
      
        <div class="post-tags">
          <i class="fa fa-tags fa-fw me-1"></i>
          
            <a
              href="/tags/ansible/"
              class="post-tag no-text-decoration"
            >ansible</a>
          
            <a
              href="/tags/manjaro/"
              class="post-tag no-text-decoration"
            >manjaro</a>
          
            <a
              href="/tags/automation/"
              class="post-tag no-text-decoration"
            >automation</a>
          
            <a
              href="/tags/infrastructure-as-code/"
              class="post-tag no-text-decoration"
            >infrastructure-as-code</a>
          
            <a
              href="/tags/linux/"
              class="post-tag no-text-decoration"
            >linux</a>
          
            <a
              href="/tags/devops/"
              class="post-tag no-text-decoration"
            >devops</a>
          
        </div>
      

      <div class="post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2">
        <div class="license-wrapper">
          
            
            This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.
          
        </div>

      </div>
    </div>
  </article>

          </main>

          
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              




  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  






  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/post/2025-12-17-claude-code-5-model-configuration/">Claude Code - Model Configuration</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/post/2025-12-14-claude-code-4-tools-permissions/">Claude Code - Tools and Permissions</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/post/2025-12-12-claude-code-3-context-management/">Claude Code - Managing Context for Better Results</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/post/2025-12-12-claude-code-2-memory-claude-md/">Claude Code - Project Memory with CLAUDE.md</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/post/2025-12-12-claude-code-1-introduction-setup/">Claude Code - Introduction &amp; Setup for Linux</a>
        </li>
      
    </ul>
  </section>
  

              





  

  

  

  

  

  

  

  

  

  

  

  









  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/ai/">ai</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/ansible/">ansible</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/automation/">automation</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/claude-code/">claude-code</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/configuration/">configuration</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/developer-tools/">developer-tools</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/devops/">devops</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/infrastructure-as-code/">infrastructure-as-code</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/linux/">linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/manjaro/">manjaro</a>
      
    </div>
  </section>

            </div>
            
  



  

  
    
  





  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


          </aside>
        </div>

        <div class="row">
          
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
  












  
  

  
  




  
  

  
  

  
  

  
  

  
  

  
  






  
    
  

  

  
  
    
  
    
  
    
  
    
      
    
  

  
  
    
  
    
  

  
    
    
  





  
  
    
    
    
  





  
  
  



  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">
      Further Reading
    </h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/post/2025-12-14-claude-code-4-tools-permissions/" class="post-preview card h-100">
            <div class="card-body">
              



<time
  
  data-ts="1765706400"
  data-df="ll"
  
>
  %b %e, %Y
</time>
              <h4 class="pt-0 my-2">Claude Code - Tools and Permissions</h4>
              <div class="text-muted">
                <p>Understanding Claude Code&#39;s built-in tools and how to manage permissions for automated workflows</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  

  <nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Older">
      <p>-</p>
    </div>
  

  
    <a
      href="/post/2025-12-12-claude-code-1-introduction-setup/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Claude Code - Introduction &amp; Setup for Linux</p>
    </a>
  
</nav>
  



            
<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    ©
    <time>2025</time>

    
      
        <a href="https://github.com/pauloportugal">Paulo Monteiro</a>.
      
    

    <span
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
    >Some rights reserved.</span>
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v1.0.2"
        href="https://github.com/geekifan/hugo-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a>.
  </p>
</footer>
          </div>
        </div>
        <div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      





  

  

  

  

  

  

  

  

  

  

  

  









  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/ai/">ai</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/ansible/">ansible</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/automation/">automation</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/claude-code/">claude-code</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/configuration/">configuration</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/developer-tools/">developer-tools</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/devops/">devops</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/infrastructure-as-code/">infrastructure-as-code</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/linux/">linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="https://pauloportugal.github.io/tags/manjaro/">manjaro</a>
      
    </div>
  </section>

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

<script>
  const DEFAULT_CONFIG = {
    search: {
      minChars: 1,              
      maxResults: 5,            
      fields: {                 
        title: true,
        description: true,
        section: true,
        contents: true
      },
      
      strictMode: true          
    }
  };

  class FastSearch {
    constructor({
      searchInput, resultsContainer, json,
      searchResultTemplate = null,
      noResultsText = null,
    }) {
      this.searchInput = searchInput;
      this.resultsContainer = resultsContainer;
      this.json = json;
      this.searchResultTemplate = searchResultTemplate;
      this.noResultsText = noResultsText;
      
      this.init();
    }

    init() {
      this.loadSearchIndex();
      this.searchInput.addEventListener('input', (event) => {
        if (!this.searchIndex) {
          this.resultsContainer.innerHTML = '<li class="search-message">Loading search index...</li>';
          return;
        }
        this.performSearch(this.searchInput.value);
      });
    }

    
    async loadSearchIndex() {
      try {
        const response = await fetch(this.json);
        if (!response.ok) throw new Error('Failed to load search index');
        const data = await response.json();
        
        this.searchIndex = data.map(item => ({
          ...item,
          
          searchableTitle: item.title?.toLowerCase() || '',
          searchableDesc: item.desc?.toLowerCase() || '',
          searchableSection: item.section?.toLowerCase() || '',
          searchableContents: item.contents?.toLowerCase() || ''
        }));
        } catch (error) {
          console.error('Error loading search index:', error);
        this.resultsContainer.innerHTML = '<li class="search-message">Error loading search index...</li>';
      }
    }

    escapeHtml(unsafe) {
      if (!unsafe) return '';
      return unsafe
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }
    
    
    containsTerm(text, term) {
      if (!text || !term) return false;
      return text.includes(term);
    }

    performSearch(query) {
      
      query = query.toLowerCase().trim();
      
      
      if (!query || !this.searchIndex || query.length < DEFAULT_CONFIG.search.minChars) {
        this.resultsContainer.innerHTML = '';
        return;
      }

      
      const searchTerms = [
        query, 
        ...query.split(/\s+/).filter(term => term.length > 0) 
      ];
      
      
      const uniqueTerms = [...new Set(searchTerms)];
      
      
      const requireFullQueryMatch = DEFAULT_CONFIG.search.strictMode;
      
      
      const results = this.searchIndex
        .map(item => {
          
          const fullQueryMatched = this.checkFieldsForMatch(item, uniqueTerms[0]);
          
          
          if (requireFullQueryMatch && !fullQueryMatched) {
            return { item, score: 0, matched: false };
          }
          
          
          let score = 0;
          let matchedTermsCount = 0;
          let matchedInTitle = false;
          
          
          uniqueTerms.forEach((term, index) => {
            
            const isFullQuery = index === 0;
            const matched = this.checkFieldsForMatch(item, term);
            
            if (matched) {
              matchedTermsCount++;
              
              
              if (matched.inTitle) {
                score += isFullQuery ? 10 : 5;
                matchedInTitle = true;
              }
              if (matched.inDesc) {
                score += isFullQuery ? 8 : 4;
              }
              if (matched.inSection) {
                score += isFullQuery ? 6 : 3;
              }
              if (matched.inContents) {
                score += isFullQuery ? 4 : 2;
              }
            }
          });
          
          
          const matchRatio = matchedTermsCount / uniqueTerms.length;
          
          
          const finalScore = score * matchRatio * (matchedInTitle ? 1.5 : 1);
          
          return {
            item,
            score: finalScore,
            matched: fullQueryMatched 
          };
        })
        .filter(result => result.matched)
        .sort((a, b) => b.score - a.score)
        .slice(0, DEFAULT_CONFIG.search.maxResults)
        .map(result => result.item);

      
      if (results.length === 0) {
        this.resultsContainer.innerHTML = '<p class="mt-5">Oops! No results found.</p>';
        return;
      }

      const searchItems = results.map((item) => {
        let categories = '';
        let tags = '';
        if (item.categories) {
          categories = item.categories.join(', ');
          categories = `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${categories}</div>`;
        }
        if (item.tags) {
          tags = item.tags.join(', ');
          tags = `<div><i class="fa fa-tag fa-fw"></i>${tags}</div>`
        }
        return `
        <article class="px-1 px-sm-2 px-lg-4 px-xl-0">
          <header>
            <h2><a href="${this.escapeHtml(item.permalink)}">${this.escapeHtml(item.title)}</a></h2>
            <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">
              ${categories}
              ${tags}
            </div>
          </header>
          <p>${this.escapeHtml(item.contents)}</p>
        </article>
      `;
      }).join('');
      
      this.resultsContainer.innerHTML = searchItems;
    }
    
    
    checkFieldsForMatch(item, term) {
      const matches = {
        inTitle: false,
        inDesc: false,
        inSection: false,
        inContents: false
      };
      
      
      if (DEFAULT_CONFIG.search.fields.title && this.containsTerm(item.searchableTitle, term)) {
        matches.inTitle = true;
      }
      
      if (DEFAULT_CONFIG.search.fields.description && this.containsTerm(item.searchableDesc, term)) {
        matches.inDesc = true;
      }
      
      if (DEFAULT_CONFIG.search.fields.section && this.containsTerm(item.searchableSection, term)) {
        matches.inSection = true;
      }
      
      if (DEFAULT_CONFIG.search.fields.contents && this.containsTerm(item.searchableContents, term)) {
        matches.inContents = true;
      }
      
      
      if (matches.inTitle || matches.inDesc || matches.inSection || matches.inContents) {
        return matches;
      }
      
      
      return false;
    }
  }

  const search = new FastSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: `\/index.json`
  });

</script>
      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>
  </body>
</html>